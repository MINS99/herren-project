## 헤렌 자바 개발자 사전 과제 - 샵/직원 관리
## 프로젝트 구성
+ Project: Gradle Project
+ Language: Java11
+ Spring Boot: 2.4.5
+ Packaging: Jar
+ Dependencies : Spring Web, Spring Validation, Spring Data JPA, H2 Database, JUnit5, Rest Assured

## DB table
- 샵 정보
    - [필수, unique]고유 아이디(번호)
    - [필수]상호명
    - [필수, unique]사업자번호
    - [필수]연락처
    - [선택]카카오톡 아이디
- 직원 정보
    - [필수, unique]고유 아이디(번호)
    - [필수]이름
    - [필수, unique]연락처
    - [선택]카카오톡 아이디

## 기능 요구사항
- 샵의 상태를 추가합니다
    - 상태 : 정상, 등록대기, 삭제
    - 상태가 "삭제" 로 바뀌면 해당 샵의 사업자번호, 연락처, 카카오톡 아이디를 삭제합니다
    - 다른 상태값은 변경 시 제약이 없습니다
- 직원의 상태를 추가합니다
    - 상태 : 정상, 삭제
    - 상태가 "삭제" 로 바뀌면 아래와 같이 변경되어야 합니다
        - 해당 직원이 등록된 샵에서 제외됩니다
        - 해당 직원의 이름, 연락처, 카카오톡 아이디를 삭제합니다
- 샵 별로 직원이 등록됩니다
    - 직원이 없는 샵도 가능합니다
    - 한명의 직원은 하나의 샵에만 등록되어야 합니다
- 아래 API 를 작성해주세요
    - 샵 조회
        - 고유 아이디로 하나의 샵 정보만 조회
        - 이때 샵에 등록된 직원 정보는 리스트 형태로 조회됨
    - 샵 삭제
        - 고유 아이디를 전달받아서 샵과 관련된 정보를 삭제
    - 샵 등록
        - 필수, 선택 정보를 받아서 샵을 새로 등록
        - 등록 시 상태값을 등록대기로 등록. 다만 어드민에서 승인 후 상태값이 정상으로 바뀌는 부분은 구현하지 않아도 됨
        - 사업자번호가 중복되면 409 에러 발생
    - 직원 등록
        - 필수, 선택 정보를 받아서 직원을 새로 등록
    - 샵에 직원 등록
        - 샵 고유 아이디, 직원 고유아이디를 전달받아 샵에 직원정보를 등록
        - 샵, 직원 정보가 없다면 404 에러 발생
        - 직원이 특정 샵에 이미 등록되어 있다면 409 에러 발생. 즉, 직원은 하나의 샵에만 등록될 수 있음

---
# 어떻게 구현하고자 했는지, 왜 그런 방법을 선택했는지 기술해주세요.
## 1. 폴더 구조
```
📦 
├─ .github
│  └─ ISSUE_TEMPLATE
│     └─ custom.md
├─ .gitignore
├─ Dockerfile
├─ README.md
├─ build.gradle
├─ gradle
│  └─ wrapper
│     ├─ gradle-wrapper.jar
│     └─ gradle-wrapper.properties
├─ gradlew
├─ gradlew.bat
├─ settings.gradle
└─ src
   ├─ main
   │  ├─ java
   │  │  └─ com
   │  │     └─ herren
   │  │        └─ project
   │  │           ├─ ShopApplication.java
   │  │           ├─ employees
   │  │           │  ├─ application
   │  │           │  │  └─ EmployeeService.java
   │  │           │  ├─ domain
   │  │           │  │  ├─ Employee.java
   │  │           │  │  ├─ EmployeeRepository.java
   │  │           │  │  ├─ EmployeeStatus.java
   │  │           │  │  └─ Staff.java
   │  │           │  ├─ dto
   │  │           │  │  ├─ EmployeeCreateRequest.java
   │  │           │  │  └─ EmployeeInfoResponse.java
   │  │           │  └─ ui
   │  │           │     └─ EmployeeController.java
   │  │           ├─ exception
   │  │           │  ├─ CommonException.java
   │  │           │  ├─ CommonExceptionHandler.java
   │  │           │  ├─ ErrorCode.java
   │  │           │  └─ ErrorResponse.java
   │  │           └─ shop
   │  │              ├─ application
   │  │              │  └─ ShopService.java
   │  │              ├─ domain
   │  │              │  ├─ Shop.java
   │  │              │  ├─ ShopRepository.java
   │  │              │  └─ ShopStatus.java
   │  │              ├─ dto
   │  │              │  ├─ ShopCreateRequest.java
   │  │              │  └─ ShopInfoResponse.java
   │  │              └─ ui
   │  │                 └─ ShopController.java
   │  └─ resources
   │     └─ application.properties
   └─ test
      └─ java
         └─ com
            └─ herren
               └─ project
                  ├─ AcceptanceTest.java
                  ├─ ShopApplicationTests.java
                  ├─ employees
                  │  ├─ application
                  │  │  ├─ EmployeeServiceMockTest.java
                  │  │  └─ EmployeeServiceTest.java
                  │  ├─ domain
                  │  │  └─ EmployeeTest.java
                  │  └─ ui
                  │     └─ EmployeeAcceptanceTest.java
                  ├─ shop
                  │  ├─ application
                  │  │  ├─ ShopServiceMockTest.java
                  │  │  └─ ShopServiceTest.java
                  │  ├─ domain
                  │  │  └─ ShopTest.java
                  │  └─ ui
                  │     └─ ShopAcceptanceTest.java
                  └─ utils
                     └─ DatabaseCleanup.java
```
©generated by [Project Tree Generator](https://woochanleee.github.io/project-tree-generator)
### employees
+ 직원 관련 로직을 처리하는 패키지
### shop
+ 샵 관련 로직을 처리하는 패키지
### exception
+ 예외 관련 로직을 처리하는 패키지
### ui
+ 컨트롤러 로직
### application
+ 서비스 로직
### domain
+ 도메인 객체와 레포지토리
### dto
+ 요청/응답 객체

## 2. 구현 순서 및 의도
1. 기본 테이블 명세에 따라 도메인(Shop, Employee(Staff))을 구현하였습니다.
   1. 도메인에 대한 테스트는 junit5를 사용하였습니다.
   2. 샵과 직원은 일대다 관계로, 직원에 대한 처리를 용이하게 하기 위해 직원 객체를 일급클래스(Staff)로 구현하였습니다.
2. 각 요청에 대한 예외를 공통 클래스로 처리하였습니다
   1. `CommonExceptionHandler.class` 를 통해 특정 케이스의 예외가 던져지면 `ErrorCode`에 맞춰 ErrorResponse 객체를 응답합니다.
   2. 추후 예외 처리에 대한 확장을 고려하여 공통 예외 코드 enum `ErrorCode`와 공통 응답 객체 `ErrorResponse`를 구현하였습니다.
3. API 명세에 맞춰 기능을 구현하였습니다
   1. 서비스에 대한 테스트는 without Mock, with Mock 두 가지 테스트를 진행하였습니다.
   2. end to end 테스트로 rest assured를 사용하였습니다.
   3. 요청으로 들어오는 값에 대한 검증은 Spring validation을 통해 하였습니다.
   4. 요청과 응답의 경우 엔티티 객체와 분리하여 각 요청/응답에 대해서만 처리하는 dto 객체를 사용하였습니다.
4. 다음의 프로세스로 진행하였습니다.
   1. issue 등록 -> feature 브랜치 생성 및 작업 -> PR -> merge 후 issue close

## 3. 그 외
+ Numbers to string quiz는 [quiz](https://github.com/MINS99/herren-project/tree/quiz) 브랜치에 구현하였습니다.
+ docker build : `docker build -t shop .`
